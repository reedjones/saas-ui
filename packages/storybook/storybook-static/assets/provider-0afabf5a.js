import{j as r,r as E}from"./chunk-ZJJGQIVY-3d316dd5.js";import{r as f}from"./index-76fb7be0.js";import{A as I,a as z}from"./chunk-FQDHE43W-07eeae80.js";import{M as L}from"./chunk-RAWN7VJ3-d8d1ff9c.js";import{M as S,a as _,b as k}from"./chunk-OFOVX77R-a988abeb.js";import{B as H}from"./chunk-DA7QIPTJ-83b15474.js";import{B as F}from"./chunk-UVUR7MCU-4e62fe64.js";import{M as K}from"./menu-65386f37.js";import{F as T}from"./form-33f8becd.js";import{D as $,a as q}from"./chunk-65IR7CTH-9245a5d5.js";import{M as J}from"./chunk-4FCEGNGT-b11834d9.js";import{M as N}from"./modal-c3eb0174.js";const R=c=>{const{title:p,cancelLabel:n="Cancel",confirmLabel:a="Confirm",cancelProps:l,confirmProps:m,buttonGroupProps:i,isOpen:d,closeOnCancel:j=!0,closeOnConfirm:w=!0,leastDestructiveFocus:D="cancel",onClose:M,onCancel:v,onConfirm:C,children:A,...P}=c,O=f.useRef(null),b=f.useRef(null),[e,o]=f.useState(!1),s=async()=>{try{const t=C==null?void 0:C();typeof(t==null?void 0:t.then)=="function"&&(o(!0),await t),w&&M()}catch(t){throw t}finally{o(!1)}};return r.jsx(I,{isOpen:d,onClose:M,...P,leastDestructiveRef:D==="cancel"?O:b,children:r.jsx(S,{children:r.jsxs(z,{children:[r.jsx(_,{children:p}),r.jsx(k,{children:A}),r.jsx(L,{children:r.jsxs(H,{...i,children:[r.jsx(F,{ref:O,...l,onClick:()=>{v==null||v(),j&&M()},children:(l==null?void 0:l.children)||n}),r.jsx(F,{ref:b,isLoading:e,...m,onClick:s,children:(m==null?void 0:m.children)||a})]})})]})})})},Q=c=>{const{title:p,children:n,footer:a,isOpen:l,onClose:m,hideCloseButton:i,hideOverlay:d,headerProps:j,contentProps:w,footerProps:D,...M}=c;return r.jsxs($,{isOpen:l,onClose:m,...M,children:[!d&&r.jsx(S,{}),r.jsxs(q,{...w,children:[p&&r.jsx(_,{...j,children:p}),!i&&r.jsx(J,{}),E(n,{isOpen:l,onClose:m}),a&&r.jsx(L,{...D,children:a})]})]})},U=c=>{const{children:p,isOpen:n,onClose:a,...l}=c;return r.jsx(Q,{isOpen:n,onClose:a,...l,children:r.jsx(k,{children:E(p,{isOpen:n,onClose:a})})})},V={alert:R,confirm:R,drawer:U,modal:N,menu:K,form:T},G=f.createContext(null),g={id:null,props:null,type:"modal"};function ie({children:c,modals:p}){const n=f.useMemo(()=>new Set,[]),[a,l]=f.useState({modal:g}),m=f.useMemo(()=>{const e={...V,...p};return(o="modal")=>e[o]||e.modal},[p]),i=(e,o)=>{if(!o)return l({modal:e});l(s=>({...s,[o]:e}))},d=(e,o)=>{let s;typeof e=="function"?s={component:e,...o}:s=e;const{id:t=n.size+1,type:h="modal",scope:u="modal",component:x,...B}=s,y={id:t,props:B,type:h,scope:u,component:x,isOpen:!0};return n.add(y),i(y,u),t},j=e=>d({...e,type:"drawer"}),w=e=>d({...e,scope:"alert",type:"alert",cancelProps:{display:"none"},confirmProps:{label:"OK"},leastDestructiveFocus:"confirm"}),D=e=>d({...e,scope:"alert",type:"confirm"}),M=e=>d({...e,type:"menu"}),v=e=>d({...e,type:"form"}),C=async(e,o)=>{var x,B;const s=[...Array.from(n)],t=s.filter(y=>y.id===e)[0];if(!t||await((B=(x=t.props)==null?void 0:x.onClose)==null?void 0:B.call(x,{force:o}))===!1)return;const u=s.filter(({scope:y})=>y===t.scope);u.length===1?i({...t,isOpen:!1},t.scope):u.length>1?i(u[u.length-2],t.scope):i({id:null,props:null,type:t.type},t.scope),setTimeout(()=>A(e),200)},A=e=>{const o=[...Array.from(n)],s=o.filter(h=>h.id===e)[0];n.delete(s);const t=s&&o.filter(({scope:h})=>h===s.scope);(t==null?void 0:t.length)===1&&i(g,s.scope)},O={open:d,drawer:j,alert:w,confirm:D,menu:M,form:v,close:C,closeAll:()=>{n.forEach(e=>{var o,s;return(s=(o=e.props)==null?void 0:o.onClose)==null?void 0:s.call(o,{force:!0})}),n.clear(),i(g)}},b=f.useMemo(()=>Object.entries(a).map(([e,o])=>{const s=o.component||m(o.type),{title:t,body:h,children:u,...x}=o.props||{};return r.jsx(s,{title:t,children:h||u,...x,isOpen:!!o.isOpen,onClose:()=>C(o.id),onCloseComplete:()=>A(o.id)},e)}),[a]);return r.jsxs(G.Provider,{value:O,children:[b,c]})}const W=()=>f.useContext(G),de=()=>{const c=W();if(!c)throw new Error("useModals must be used within a ModalsProvider");return c};export{ie as M,V as d,de as u};
